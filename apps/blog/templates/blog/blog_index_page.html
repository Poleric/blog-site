{% extends "base.html" %}

{% load static wagtailcore_tags wagtailimages_tags %}

{% block body_class %}blogindexpage{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/blog.css' %}">
{% endblock %}

{% block content %}
    <section class="centered">
        <div class="content">
            <h1>{{ page.title }}</h1>

            <div class="intro">{{ page.intro|richtext }}</div>

            {% for post in blog_pages %}
                <div class="blog-post">
                    {% with post=post.specific %}
                        <div class="meta">
                            <h2><a href="{% pageurl post %}">{{ post.title }}</a></h2>
                            <time datetime="{{ post.published_at|date:"c" }}"
                            title="{{ post.published_at|date:"r" }}"
                            >
                                {{ post.published_at|date:"DATE_FORMAT" }}
                            </time>
                        </div>

                        <div class="content">
                            {% with post.main_image as main_image %}
                                {% if main_image %}{% image main_image fill-240x160 %}{% endif %}
                            {% endwith %}

                            {{ post.intro }}

                            {{ post.body | truncatewords:30}}
                        </div>
                    {% endwith %}
                </div>
            {% endfor %}
        </div>
    </section>
{% endblock %}